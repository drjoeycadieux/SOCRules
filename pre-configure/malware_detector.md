# Malware YARA Rule

This repository contains the `SimpleMalware` YARA rule, designed to detect a basic malware pattern. It identifies suspicious files based on specific strings, hexadecimal patterns, or known malicious URLs.

## Rule Overview

```yara
rule SimpleMalware
{
    meta:
        description = "Detects a simple malware pattern"
        author = "Your Name"
        date = "2025-01-01"
        version = "1.0"

    strings:
        $malicious_string = "malicious_function()" // Example string
        $suspicious_hex = { E8 ?? ?? ?? ?? 83 C4 04 C3 } // Example hexadecimal pattern
        $url_pattern = "http://malicious-site.com"

    condition:
        any of them
}
```

### Features
- Detects malware based on textual and binary patterns.
- Identifies suspicious URLs associated with malicious activities.
- Simple and easy to extend.

## How to Use

### Prerequisites
- Install [YARA](https://github.com/VirusTotal/yara):
  ```bash
  sudo apt install yara  # On Debian-based systems
  ```

### Save the Rule
1. Copy the rule to a file named `SimpleMalware.yar`.
2. Ensure the file is saved with UTF-8 encoding.

### Scan Files
Use YARA to scan files or directories:

#### Scan a Single File
```bash
yara SimpleMalware.yar /path/to/file
```

#### Scan a Directory
```bash
yara -r SimpleMalware.yar /path/to/directory
```

### Example Output
```bash
SimpleMalware /path/to/suspicious_file.exe
```

### Debugging
To debug or analyze why a rule did or did not match, use the `-d` option:
```bash
yara -d SimpleMalware.yar /path/to/file
```

## Extending the Rule
To add more patterns or refine the rule:
1. Add new strings or hexadecimal sequences under the `strings` section.
2. Update the `condition` section with the desired logic (e.g., `all of them`, `2 of them`).

## Disclaimer
This rule is a simple demonstration and may produce false positives. Test it thoroughly before deploying in production.

## License
This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
